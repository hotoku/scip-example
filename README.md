# SCIPで2次計画を解いてみる

次のような最適化問題を考える。

- 変数は、 $x[0], x[1], \ldots, x[n-1]$
- 目標は、 これらの平均と分散の加重和を最小化すること。つまり、適当な定数 $a$ に対して、

$$
\mathrm{minimize}\ \frac{a}{n} \sum_{i=0}^{n-1}x[i] + \frac{1}{n} \sum_{i=0}^{n-1}x[i]^2 - \left( \frac{1}{n} \sum_{i=0}^{n-1}x[i] \right)^2
$$

- 別途与えられた定数の配列 $d[0], d[1], \ldots, d[n-1]$ に対して、次を制約条件とする

$$
\sum_{i=1}^t x[i] \geq \sum_{i=1}^t d[i],\ (t=0, 1, \ldots, n-1)
$$

## 計数を算出する

LPファイルで上の問題を書き下すために、目的関数の式を展開すると、以下のように計算できる。

- $x[i]$ の係数 = $\frac{a}{n}$
- $x[i]^2$ の係数 = $\frac{1}{n} - \frac{1}{n^2}$
- $x[i]x[j]$ の係数 = $-\frac{2}{n^2}$, ただし、 $i < j$

## LPファイルを書く

`n = 10`の例に対して、上の問題をLPに書き下すPythonスクリプトを書いた。

```shell
$ python makelp.py > quad.lp
```

上のコマンドにより、この問題をLPフォーマットで書き下したファイルが得られる。

## 最適化問題を解く
scipを起動し、以下のコマンドを順に実行することで、上で作成したquad.lpを読み込み、
最適化問題の解が得られる・・と思ってるんだけど、上手くいってない。

```shell
> read quad.lp
> optimize
> display solution
```
